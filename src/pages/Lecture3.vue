<template>
  <div class="lecture-content">
    <header class="lecture-header">
      <h1>ç¬¬3è®²ï¼šå®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†</h1>
      <p class="intro">æ·±å…¥æŒæ¡å®¹å™¨çš„å¯åŠ¨ã€åœæ­¢ã€é‡å¯ã€åˆ é™¤æ“ä½œï¼Œå­¦ä¼šæŸ¥çœ‹æ—¥å¿—ã€è¿›å…¥å®¹å™¨è°ƒè¯•ï¼Œç†è§£å®¹å™¨èµ„æºé™åˆ¶ã€‚</p>
      
      <div class="pill-list">
        <span class="pill">å®¹å™¨æ§åˆ¶</span>
        <span class="pill">æ—¥å¿—æŸ¥çœ‹</span>
        <span class="pill">è¿›å…¥å®¹å™¨</span>
        <span class="pill">èµ„æºé™åˆ¶</span>
      </div>
    </header>

    <LectureSidebar :sections="sections" />

    <section id="intro">
      <h2>ğŸ‘‹ è¯¾ç¨‹ç›®æ ‡</h2>
      <ul class="goal-list">
        <li>æŒæ¡å®¹å™¨çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸç®¡ç†</li>
        <li>å­¦ä¼šä½¿ç”¨æ—¥å¿—æ’æŸ¥å®¹å™¨é—®é¢˜</li>
        <li>ç†Ÿç»ƒè¿›å…¥å®¹å™¨è¿›è¡Œè°ƒè¯•</li>
        <li>ç†è§£å¹¶è®¾ç½®å®¹å™¨èµ„æºé™åˆ¶</li>
      </ul>
    </section>

    <section id="chapter-1">
      <h2>ä¸€ã€å®¹å™¨ç”Ÿå‘½å‘¨æœŸå®Œæ•´è§£æ</h2>
      
      <h3>1.1 å®¹å™¨çŠ¶æ€è¯¦è§£</h3>
      <div class="concept-box">
        <h4>ğŸ“Š å®¹å™¨çš„ä¸ƒç§çŠ¶æ€</h4>
        <table class="comparison-table">
          <thead>
            <tr>
              <th>çŠ¶æ€</th>
              <th>è¯´æ˜</th>
              <th>å¦‚ä½•è¿›å…¥</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>created</code></td>
              <td>å·²åˆ›å»ºä½†æœªå¯åŠ¨</td>
              <td><code>docker create nginx</code></td>
            </tr>
            <tr>
              <td><code>running</code></td>
              <td>æ­£åœ¨è¿è¡Œ</td>
              <td><code>docker start</code> æˆ– <code>docker run</code></td>
            </tr>
            <tr>
              <td><code>paused</code></td>
              <td>å·²æš‚åœï¼ˆè¿›ç¨‹å†»ç»“ï¼‰</td>
              <td><code>docker pause</code></td>
            </tr>
            <tr>
              <td><code>restarting</code></td>
              <td>æ­£åœ¨é‡å¯</td>
              <td><code>docker restart</code></td>
            </tr>
            <tr>
              <td><code>exited</code></td>
              <td>å·²é€€å‡ºï¼ˆåœæ­¢ï¼‰</td>
              <td><code>docker stop</code> æˆ–å®¹å™¨å†…è¿›ç¨‹ç»“æŸ</td>
            </tr>
            <tr>
              <td><code>dead</code></td>
              <td>æ­»äº¡ï¼ˆæ— æ³•å¯åŠ¨ï¼‰</td>
              <td>å®¹å™¨å¯åŠ¨å¤±è´¥</td>
            </tr>
            <tr>
              <td><code>removing</code></td>
              <td>æ­£åœ¨åˆ é™¤</td>
              <td><code>docker rm</code></td>
            </tr>
          </tbody>
        </table>
      </div>

      <h3>1.2 åˆ›å»ºå®¹å™¨ vs è¿è¡Œå®¹å™¨</h3>
      <div class="experiment-box">
        <h4>ğŸ§ª å®éªŒ 1ï¼šç†è§£ create å’Œ run çš„åŒºåˆ«</h4>
        <pre><code># æ–¹æ³•ä¸€ï¼šcreate + startï¼ˆä¸¤æ­¥ï¼‰
docker create --name web1 nginx
# è¾“å‡ºå®¹å™¨ IDï¼Œä½†å®¹å™¨æœªå¯åŠ¨

docker ps                    # çœ‹ä¸åˆ° web1
docker ps -a                 # èƒ½çœ‹åˆ° web1ï¼ŒçŠ¶æ€ä¸º Created

docker start web1            # å¯åŠ¨å®¹å™¨
docker ps                    # ç°åœ¨èƒ½çœ‹åˆ°äº†

# æ–¹æ³•äºŒï¼šrunï¼ˆä¸€æ­¥åˆ°ä½ï¼‰
docker run -d --name web2 nginx
# ç›¸å½“äº create + start çš„ç»„åˆ

# éªŒè¯
docker ps
# CONTAINER ID   IMAGE   STATUS          NAMES
# a1b2c3d4       nginx   Up 5 seconds    web1
# e5f6g7h8       nginx   Up 2 seconds    web2</code></pre>
        
        <p><strong>åŒºåˆ«æ€»ç»“ï¼š</strong></p>
        <ul>
          <li><code>docker create</code>ï¼šåªåˆ›å»ºå®¹å™¨ï¼Œä¸å¯åŠ¨ï¼ˆç”¨äºé¢„é…ç½®ï¼‰</li>
          <li><code>docker run</code> = <code>docker create</code> + <code>docker start</code></li>
          <li><code>docker run -d</code>ï¼šåå°è¿è¡Œ</li>
          <li><code>docker run -it</code>ï¼šäº¤äº’å¼è¿è¡Œ</li>
        </ul>
      </div>

      <h3>1.3 å®¹å™¨å¯åœæ“ä½œ</h3>
      <div class="experiment-box">
        <h4>ğŸ§ª å®éªŒ 2ï¼šå®¹å™¨çš„å¯åŠ¨ã€åœæ­¢ã€é‡å¯</h4>
        <pre><code># å¯åŠ¨ä¸€ä¸ª Nginx å®¹å™¨
docker run -d --name my-web -p 8080:80 nginx

# éªŒè¯è¿è¡Œ
docker ps
curl http://localhost:8080    # æˆ–æµè§ˆå™¨è®¿é—®

# === åœæ­¢å®¹å™¨ ===
docker stop my-web            # ä¼˜é›…åœæ­¢ï¼ˆç»™ 10 ç§’å…³é—­æ—¶é—´ï¼‰
# åŸç†ï¼šå‘é€ SIGTERM ä¿¡å·ï¼Œç­‰å¾…è¿›ç¨‹ä¼˜é›…é€€å‡º

# å¼ºåˆ¶åœæ­¢ï¼ˆç«‹å³æ€æ­»ï¼‰
docker kill my-web            # å‘é€ SIGKILLï¼Œå¼ºåˆ¶ç»“æŸ
# ä¸€èˆ¬ä¸æ¨èï¼Œå¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±

# === å¯åŠ¨å·²åœæ­¢çš„å®¹å™¨ ===
docker start my-web           # å¯åŠ¨
docker ps                     # éªŒè¯çŠ¶æ€å˜ä¸º Up

# === é‡å¯å®¹å™¨ ===
docker restart my-web         # ç›¸å½“äº stop + start

# === æš‚åœå’Œæ¢å¤ ===
docker pause my-web           # æš‚åœï¼ˆè¿›ç¨‹å†»ç»“ï¼Œä½†ä¸é‡Šæ”¾èµ„æºï¼‰
docker ps                     # çŠ¶æ€æ˜¾ç¤º Paused
# æ­¤æ—¶è®¿é—® http://localhost:8080 æ— å“åº”

docker unpause my-web         # æ¢å¤
# ç¬é—´æ¢å¤ï¼Œæ¯” stop/start å¿«</code></pre>

        <div class="key-point">
          <h4>ğŸ¯ stop vs kill vs pause</h4>
          <ul>
            <li><strong>stop</strong>ï¼šä¼˜é›…åœæ­¢ï¼Œé€‚åˆç”Ÿäº§ç¯å¢ƒï¼ˆé»˜è®¤ç­‰å¾… 10 ç§’ï¼‰</li>
            <li><strong>kill</strong>ï¼šå¼ºåˆ¶åœæ­¢ï¼Œç´§æ€¥æƒ…å†µä½¿ç”¨</li>
            <li><strong>pause</strong>ï¼šå†»ç»“è¿›ç¨‹ï¼Œç”¨äºä¸´æ—¶æš‚åœï¼ˆä¸å¸¸ç”¨ï¼‰</li>
          </ul>
        </div>
      </div>
    </section>

    <section id="chapter-2">
      <h2>äºŒã€å®¹å™¨æ—¥å¿—ç®¡ç†</h2>
      
      <h3>2.1 æŸ¥çœ‹å®¹å™¨æ—¥å¿—</h3>
      <div class="experiment-box">
        <h4>ğŸ§ª å®éªŒ 3ï¼šæ—¥å¿—æŸ¥çœ‹çš„å¤šç§æ–¹å¼</h4>
        <pre><code># å¯åŠ¨ä¸€ä¸ªä¼šäº§ç”Ÿæ—¥å¿—çš„å®¹å™¨
docker run -d --name log-demo nginx

# === æŸ¥çœ‹æ‰€æœ‰æ—¥å¿— ===
docker logs log-demo

# è¾“å‡ºç¤ºä¾‹ï¼š
# /docker-entrypoint.sh: /docker-entrypoint.d/ is not empty
# /docker-entrypoint.sh: Configuration complete; ready for start up
# 2025/12/26 10:30:00 [notice] 1#1: nginx/1.25.3
# 2025/12/26 10:30:00 [notice] 1#1: start worker processes

# === å®æ—¶è·Ÿè¸ªæ—¥å¿—ï¼ˆç±»ä¼¼ tail -fï¼‰===
docker logs -f log-demo       # Ctrl+C é€€å‡º

# === æŸ¥çœ‹æœ€å N è¡Œ ===
docker logs --tail 20 log-demo        # æœ€å 20 è¡Œ
docker logs --tail 100 log-demo       # æœ€å 100 è¡Œ

# === æŸ¥çœ‹æŒ‡å®šæ—¶é—´èŒƒå›´ ===
docker logs --since 10m log-demo      # æœ€è¿‘ 10 åˆ†é’Ÿ
docker logs --since 1h log-demo       # æœ€è¿‘ 1 å°æ—¶
docker logs --since "2025-12-26T10:00:00" log-demo

# === æ˜¾ç¤ºæ—¶é—´æˆ³ ===
docker logs -t log-demo               # æ¯è¡Œå‰é¢æ˜¾ç¤ºæ—¶é—´

# === ç»„åˆä½¿ç”¨ ===
docker logs -f --tail 50 --since 5m log-demo
# æœ€è¿‘ 5 åˆ†é’Ÿçš„æœ€å 50 è¡Œï¼Œå¹¶å®æ—¶è·Ÿè¸ª</code></pre>
      </div>

      <h3>2.2 æ—¥å¿—é©±åŠ¨å’Œé…ç½®</h3>
      <div class="concept-box">
        <h4>ğŸ“Š Docker æ—¥å¿—é©±åŠ¨</h4>
        <p>Docker æ”¯æŒå¤šç§æ—¥å¿—é©±åŠ¨ï¼ˆlogging driverï¼‰ï¼š</p>
        <ul>
          <li><strong>json-file</strong>ï¼ˆé»˜è®¤ï¼‰ï¼šå­˜å‚¨ä¸º JSON æ–‡ä»¶</li>
          <li><strong>syslog</strong>ï¼šå‘é€åˆ° syslog</li>
          <li><strong>journald</strong>ï¼šå‘é€åˆ° systemd journal</li>
          <li><strong>gelf</strong>ï¼šå‘é€åˆ° Graylog</li>
          <li><strong>fluentd</strong>ï¼šå‘é€åˆ° Fluentd</li>
          <li><strong>none</strong>ï¼šä¸è®°å½•æ—¥å¿—</li>
        </ul>

        <pre><code># æŸ¥çœ‹æ—¥å¿—é©±åŠ¨é…ç½®
docker info | grep "Logging Driver"

# è¿è¡Œæ—¶æŒ‡å®šæ—¥å¿—é©±åŠ¨
docker run -d --log-driver json-file --log-opt max-size=10m --log-opt max-file=3 nginx

# é™åˆ¶æ—¥å¿—å¤§å°ï¼ˆé˜²æ­¢ç£ç›˜å æ»¡ï¼‰
# max-size: å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§å¤§å°
# max-file: ä¿ç•™çš„æ—¥å¿—æ–‡ä»¶æ•°é‡</code></pre>
      </div>

      <h3>2.3 åº”ç”¨å†…æ—¥å¿— vs å®¹å™¨æ—¥å¿—</h3>
      <div class="example-box">
        <h4>ğŸ’¡ æ—¥å¿—æœ€ä½³å®è·µ</h4>
        <pre><code># âŒ é”™è¯¯åšæ³•ï¼šåº”ç”¨æ—¥å¿—å†™å…¥æ–‡ä»¶
# åº”ç”¨å°†æ—¥å¿—å†™å…¥ /var/log/app.log
# å®¹å™¨åœæ­¢åæ—¥å¿—ä¸¢å¤±

# âœ… æ­£ç¡®åšæ³•ï¼šåº”ç”¨æ—¥å¿—è¾“å‡ºåˆ° stdout/stderr
# åº”ç”¨å°†æ—¥å¿—æ‰“å°åˆ°æ ‡å‡†è¾“å‡º
print("æ—¥å¿—ä¿¡æ¯")              # Python
console.log("æ—¥å¿—ä¿¡æ¯")        # Node.js
echo "æ—¥å¿—ä¿¡æ¯"                # Shell

# Docker ä¼šè‡ªåŠ¨æ•è· stdout/stderrï¼Œé€šè¿‡ docker logs æŸ¥çœ‹</code></pre>
      </div>
    </section>

    <section id="chapter-3">
      <h2>ä¸‰ã€è¿›å…¥å®¹å™¨è°ƒè¯•</h2>
      
      <h3>3.1 execï¼šåœ¨è¿è¡Œä¸­çš„å®¹å™¨æ‰§è¡Œå‘½ä»¤</h3>
      <div class="experiment-box">
        <h4>ğŸ§ª å®éªŒ 4ï¼šexec å‘½ä»¤è¯¦è§£</h4>
        <pre><code># å¯åŠ¨ä¸€ä¸ªå®¹å™¨
docker run -d --name debug-demo nginx

# === äº¤äº’å¼è¿›å…¥å®¹å™¨ ===
docker exec -it debug-demo bash
# ç°åœ¨ä½ åœ¨å®¹å™¨å†…äº†
root@abc123:/# 

# å®¹å™¨å†…æ“ä½œç¤ºä¾‹
pwd                           # å½“å‰ç›®å½•
ls -la                        # æŸ¥çœ‹æ–‡ä»¶
cat /etc/nginx/nginx.conf     # æŸ¥çœ‹ Nginx é…ç½®
ps aux                        # æŸ¥çœ‹è¿›ç¨‹
apt update && apt install -y curl
curl localhost                # æµ‹è¯• Nginx

# é€€å‡ºå®¹å™¨ï¼ˆå®¹å™¨ç»§ç»­è¿è¡Œï¼‰
exit

# === åœ¨å®¹å™¨å†…æ‰§è¡Œå•æ¡å‘½ä»¤ ===
docker exec debug-demo ls /etc/nginx
docker exec debug-demo cat /etc/nginx/nginx.conf
docker exec debug-demo ps aux

# === ä»¥ç‰¹å®šç”¨æˆ·æ‰§è¡Œ ===
docker exec -u root debug-demo whoami       # ä»¥ root æ‰§è¡Œ
docker exec -u nginx debug-demo whoami      # ä»¥ nginx ç”¨æˆ·æ‰§è¡Œ

# === æŒ‡å®šå·¥ä½œç›®å½• ===
docker exec -w /etc/nginx debug-demo pwd    # åœ¨ /etc/nginx ç›®å½•æ‰§è¡Œ

# === è®¾ç½®ç¯å¢ƒå˜é‡ ===
docker exec -e MY_VAR=hello debug-demo env | grep MY_VAR</code></pre>
      </div>

      <h3>3.2 exec vs attach çš„åŒºåˆ«</h3>
      <div class="comparison-box">
        <div class="compare-item">
          <h4>docker exec</h4>
          <ul>
            <li>âœ… åœ¨å®¹å™¨å†…<strong>æ–°å»ºè¿›ç¨‹</strong></li>
            <li>âœ… é€€å‡ºä¸å½±å“å®¹å™¨</li>
            <li>âœ… å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤</li>
            <li>âœ… <strong>æ¨èä½¿ç”¨</strong></li>
          </ul>
          <pre><code>docker exec -it &lt;å®¹å™¨&gt; bash
# æ–°å»º bash è¿›ç¨‹
# exit åå®¹å™¨ç»§ç»­è¿è¡Œ</code></pre>
        </div>

        <div class="compare-item">
          <h4>docker attach</h4>
          <ul>
            <li>âš ï¸ è¿æ¥åˆ°å®¹å™¨<strong>ä¸»è¿›ç¨‹</strong></li>
            <li>âš ï¸ é€€å‡ºä¼šåœæ­¢å®¹å™¨</li>
            <li>âš ï¸ åªèƒ½æŸ¥çœ‹ä¸»è¿›ç¨‹è¾“å‡º</li>
            <li>âš ï¸ ä¸æ¨èä½¿ç”¨</li>
          </ul>
          <pre><code>docker attach &lt;å®¹å™¨&gt;
# è¿æ¥åˆ°å®¹å™¨ä¸»è¿›ç¨‹
# Ctrl+C ä¼šåœæ­¢å®¹å™¨ï¼
# Ctrl+P Ctrl+Q å¯ä»¥å®‰å…¨é€€å‡º</code></pre>
        </div>
      </div>

      <h3>3.3 ä»å®¹å™¨å¤åˆ¶æ–‡ä»¶</h3>
      <div class="experiment-box">
        <h4>ğŸ§ª å®éªŒ 5ï¼šå®¹å™¨ä¸ä¸»æœºé—´çš„æ–‡ä»¶ä¼ è¾“</h4>
        <pre><code># å¯åŠ¨å®¹å™¨
docker run -d --name file-demo nginx

# === ä»å®¹å™¨å¤åˆ¶åˆ°ä¸»æœº ===
docker cp file-demo:/etc/nginx/nginx.conf ./nginx.conf
# å¤åˆ¶ Nginx é…ç½®æ–‡ä»¶åˆ°å½“å‰ç›®å½•

docker cp file-demo:/var/log/nginx ./nginx-logs
# å¤åˆ¶æ•´ä¸ªç›®å½•

# === ä»ä¸»æœºå¤åˆ¶åˆ°å®¹å™¨ ===
echo "Hello Docker" > test.txt
docker cp test.txt file-demo:/tmp/test.txt

# éªŒè¯
docker exec file-demo cat /tmp/test.txt
# è¾“å‡ºï¼šHello Docker

# === å¤åˆ¶å¹¶é‡å‘½å ===
docker cp file-demo:/etc/nginx/nginx.conf ./my-config.conf</code></pre>
      </div>
    </section>

    <section id="chapter-4">
      <h2>å››ã€å®¹å™¨èµ„æºé™åˆ¶</h2>
      
      <h3>4.1 ä¸ºä»€ä¹ˆè¦é™åˆ¶èµ„æºï¼Ÿ</h3>
      <div class="example-box">
        <h4>ğŸ’¡ çœŸå®åœºæ™¯</h4>
        <p>å¦‚æœä¸é™åˆ¶èµ„æºï¼Œå•ä¸ªå®¹å™¨å¯èƒ½ï¼š</p>
        <ul>
          <li>ğŸ’¥ å ç”¨æ‰€æœ‰ CPUï¼Œå¯¼è‡´å…¶ä»–å®¹å™¨å¡æ­»</li>
          <li>ğŸ’¥ æ¶ˆè€—æ‰€æœ‰å†…å­˜ï¼Œè§¦å‘ OOMï¼ˆOut of Memoryï¼‰</li>
          <li>ğŸ’¥ è€—å°½ç£ç›˜ I/Oï¼Œæ‹–æ…¢æ•´ä¸ªç³»ç»Ÿ</li>
        </ul>
      </div>

      <h3>4.2 CPU é™åˆ¶</h3>
      <div class="experiment-box">
        <h4>ğŸ§ª å®éªŒ 6ï¼šé™åˆ¶ CPU ä½¿ç”¨</h4>
        <pre><code># === CPU ä»½é¢ï¼ˆç›¸å¯¹æƒé‡ï¼‰===
docker run -d --name cpu-low --cpus="0.5" nginx
# æœ€å¤šä½¿ç”¨ 0.5 ä¸ª CPUï¼ˆ50% çš„ä¸€ä¸ªæ ¸å¿ƒï¼‰

docker run -d --name cpu-high --cpus="2" nginx
# æœ€å¤šä½¿ç”¨ 2 ä¸ª CPU

# === CPU ä»½é¢æƒé‡ï¼ˆå¤šä¸ªå®¹å™¨ç«äº‰æ—¶ï¼‰===
docker run -d --cpu-shares=512 --name share-low nginx
docker run -d --cpu-shares=1024 --name share-high nginx
# share-high è·å¾—çš„ CPU æ—¶é—´æ˜¯ share-low çš„ 2 å€

# === æŒ‡å®š CPU æ ¸å¿ƒ ===
docker run -d --cpuset-cpus="0,1" --name cpu-core nginx
# åªåœ¨ CPU 0 å’Œ 1 ä¸Šè¿è¡Œ

# === æŸ¥çœ‹èµ„æºä½¿ç”¨æƒ…å†µ ===
docker stats
# å®æ—¶æ˜¾ç¤ºæ¯ä¸ªå®¹å™¨çš„ CPUã€å†…å­˜ã€ç½‘ç»œã€IO ä½¿ç”¨ç‡</code></pre>
      </div>

      <h3>4.3 å†…å­˜é™åˆ¶</h3>
      <div class="experiment-box">
        <h4>ğŸ§ª å®éªŒ 7ï¼šé™åˆ¶å†…å­˜ä½¿ç”¨</h4>
        <pre><code># === ç¡¬é™åˆ¶ï¼ˆè¶…è¿‡ä¼šè¢« Killï¼‰===
docker run -d --memory="512m" --name mem-limit nginx
# æœ€å¤šä½¿ç”¨ 512MB å†…å­˜ï¼Œè¶…è¿‡ä¼šè§¦å‘ OOM

docker run -d --memory="1g" --name mem-1g nginx
# æœ€å¤šä½¿ç”¨ 1GB

# === å†…å­˜ + Swap é™åˆ¶ ===
docker run -d \
  --memory="512m" \
  --memory-swap="1g" \
  --name mem-swap nginx
# å†…å­˜ 512MB + Swap 512MB = æ€»å…± 1GB

# === ç¦ç”¨ Swap ===
docker run -d --memory="512m" --memory-swap="512m" --name no-swap nginx
# memory-swap = memory æ—¶ï¼Œç¦ç”¨ swap

# === å†…å­˜é¢„ç•™ï¼ˆè½¯é™åˆ¶ï¼‰===
docker run -d --memory-reservation="256m" --name mem-reserve nginx
# å»ºè®®ä½¿ç”¨ä¸è¶…è¿‡ 256MBï¼Œä½†ä¸å¼ºåˆ¶

# === æµ‹è¯•å†…å­˜é™åˆ¶ ===
docker run -it --memory="100m" ubuntu bash
# åœ¨å®¹å™¨å†…æ‰§è¡Œ
apt update && apt install -y stress
stress --vm 1 --vm-bytes 150M --timeout 10s
# è¶…è¿‡ 100MBï¼Œå®¹å™¨è¢« Kill</code></pre>

        <div class="key-point">
          <h4>âš ï¸ å†…å­˜é™åˆ¶æ³¨æ„äº‹é¡¹</h4>
          <ul>
            <li>è®¾ç½®è¿‡å°ä¼šå¯¼è‡´å®¹å™¨é¢‘ç¹é‡å¯ï¼ˆOOMï¼‰</li>
            <li>Java åº”ç”¨éœ€è¦è®¾ç½® JVM å‚æ•°ï¼š<code>-Xmx</code> å°äºå®¹å™¨é™åˆ¶</li>
            <li>ç”Ÿäº§ç¯å¢ƒå»ºè®®ç•™å‡º 20-30% çš„ä½™é‡</li>
          </ul>
        </div>
      </div>

      <h3>4.4 ç£ç›˜ I/O é™åˆ¶</h3>
      <pre><code># é™åˆ¶è¯»å†™é€Ÿåº¦
docker run -d \
  --device-read-bps /dev/sda:1mb \
  --device-write-bps /dev/sda:1mb \
  --name io-limit nginx

# é™åˆ¶ IOPSï¼ˆæ¯ç§’è¯»å†™æ¬¡æ•°ï¼‰
docker run -d \
  --device-read-iops /dev/sda:100 \
  --device-write-iops /dev/sda:100 \
  --name iops-limit nginx</code></pre>

      <h3>4.5 ç»¼åˆèµ„æºé™åˆ¶ç¤ºä¾‹</h3>
      <div class="experiment-box">
        <h4>ğŸ§ª å®éªŒ 8ï¼šç”Ÿäº§ç¯å¢ƒèµ„æºé…ç½®</h4>
        <pre><code># å…¸å‹çš„ç”Ÿäº§ç¯å¢ƒé…ç½®
docker run -d \
  --name production-app \
  --cpus="2" \
  --memory="2g" \
  --memory-reservation="1.5g" \
  --restart=unless-stopped \
  -p 8080:8080 \
  -e JAVA_OPTS="-Xmx1536m" \
  my-java-app:latest

# å‚æ•°è¯´æ˜
# --cpus="2": æœ€å¤š 2 ä¸ª CPU
# --memory="2g": ç¡¬é™åˆ¶ 2GB
# --memory-reservation="1.5g": è½¯é™åˆ¶ 1.5GB
# --restart=unless-stopped: è‡ªåŠ¨é‡å¯
# -Xmx1536m: JVM å †å†…å­˜ï¼ˆå®¹å™¨å†…å­˜çš„ 75%ï¼‰</code></pre>
      </div>
    </section>

    <section id="chapter-5">
      <h2>äº”ã€å®¹å™¨æ¸…ç†ä¸ç»´æŠ¤</h2>
      
      <h3>5.1 åˆ é™¤å®¹å™¨</h3>
      <pre><code># åˆ é™¤å•ä¸ªå®¹å™¨
docker rm &lt;å®¹å™¨IDæˆ–åç§°&gt;          # å¿…é¡»å…ˆåœæ­¢
docker rm -f &lt;å®¹å™¨IDæˆ–åç§°&gt;       # å¼ºåˆ¶åˆ é™¤ï¼ˆè¿è¡Œä¸­çš„ä¹Ÿåˆ ï¼‰

# æ‰¹é‡åˆ é™¤
docker rm $(docker ps -aq)          # åˆ é™¤æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨
docker container prune              # åˆ é™¤æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨ï¼ˆæ¨èï¼‰

# åˆ é™¤æ‰€æœ‰å®¹å™¨ï¼ˆå±é™©ï¼ï¼‰
docker rm -f $(docker ps -aq)</code></pre>

      <h3>5.2 è‡ªåŠ¨æ¸…ç†</h3>
      <div class="experiment-box">
        <h4>ğŸ§ª å®éªŒ 9ï¼šå®¹å™¨è‡ªåŠ¨æ¸…ç†</h4>
        <pre><code># å®¹å™¨é€€å‡ºåè‡ªåŠ¨åˆ é™¤
docker run --rm -it ubuntu bash
# exit åå®¹å™¨è‡ªåŠ¨åˆ é™¤ï¼Œé€‚åˆä¸´æ—¶æµ‹è¯•

# ç¤ºä¾‹ï¼šä¸´æ—¶è¿è¡Œ Python è„šæœ¬
docker run --rm python:3.11 python -c "print('Hello')"
# æ‰§è¡Œå®Œè‡ªåŠ¨åˆ é™¤

# å®šæœŸæ¸…ç†ç³»ç»Ÿ
docker system prune                 # æ¸…ç†æœªä½¿ç”¨çš„å®¹å™¨ã€ç½‘ç»œã€é•œåƒ
docker system prune -a              # æ¸…ç†æ‰€æœ‰æœªä½¿ç”¨èµ„æº
docker system prune -a --volumes    # è¿æ•°æ®å·ä¹Ÿæ¸…ç†ï¼ˆå±é™©ï¼‰</code></pre>
      </div>

      <h3>5.3 å®¹å™¨é‡å¯ç­–ç•¥</h3>
      <div class="concept-box">
        <h4>ğŸ“Š é‡å¯ç­–ç•¥è¯¦è§£</h4>
        <table class="comparison-table">
          <thead>
            <tr>
              <th>ç­–ç•¥</th>
              <th>è¯´æ˜</th>
              <th>ä½¿ç”¨åœºæ™¯</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>no</code></td>
              <td>æ°¸ä¸é‡å¯ï¼ˆé»˜è®¤ï¼‰</td>
              <td>ä¸´æ—¶æµ‹è¯•å®¹å™¨</td>
            </tr>
            <tr>
              <td><code>on-failure</code></td>
              <td>å¤±è´¥æ—¶é‡å¯</td>
              <td>å¼€å‘ç¯å¢ƒ</td>
            </tr>
            <tr>
              <td><code>always</code></td>
              <td>æ€»æ˜¯é‡å¯</td>
              <td>å®ˆæŠ¤è¿›ç¨‹</td>
            </tr>
            <tr>
              <td><code>unless-stopped</code></td>
              <td>é™¤éæ‰‹åŠ¨åœæ­¢</td>
              <td>ç”Ÿäº§ç¯å¢ƒï¼ˆæ¨èï¼‰</td>
            </tr>
          </tbody>
        </table>

        <pre><code># å¤±è´¥æ—¶é‡å¯ï¼ˆæœ€å¤š 3 æ¬¡ï¼‰
docker run -d --restart=on-failure:3 nginx

# æ€»æ˜¯é‡å¯
docker run -d --restart=always nginx

# é™¤éæ‰‹åŠ¨åœæ­¢æ‰é‡å¯
docker run -d --restart=unless-stopped nginx

# ä¿®æ”¹å·²æœ‰å®¹å™¨çš„é‡å¯ç­–ç•¥
docker update --restart=unless-stopped my-container</code></pre>
      </div>
    </section>

    <section id="practice">
      <h2>å…­ã€ç»¼åˆç»ƒä¹ </h2>
      
      <div class="practice-box">
        <h3>ç»ƒä¹  1ï¼šå®Œæ•´çš„å®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†</h3>
        <pre><code># 1. åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨
docker run -d --name practice-web -p 8080:80 nginx

# 2. æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps
docker logs practice-web

# 3. è¿›å…¥å®¹å™¨ä¿®æ”¹é…ç½®
docker exec -it practice-web bash
echo "Hello from Container" > /usr/share/nginx/html/index.html
exit

# 4. éªŒè¯ä¿®æ”¹
curl http://localhost:8080

# 5. æŸ¥çœ‹èµ„æºä½¿ç”¨
docker stats practice-web --no-stream

# 6. é‡å¯å®¹å™¨
docker restart practice-web

# 7. æ¸…ç†
docker stop practice-web
docker rm practice-web</code></pre>
      </div>

      <div class="practice-box">
        <h3>ç»ƒä¹  2ï¼šèµ„æºé™åˆ¶å®æˆ˜</h3>
        <pre><code># åˆ›å»ºèµ„æºå—é™çš„å®¹å™¨
docker run -d \
  --name resource-limit \
  --cpus="1" \
  --memory="512m" \
  --restart=unless-stopped \
  -p 8081:80 \
  nginx

# å®æ—¶ç›‘æ§èµ„æºä½¿ç”¨
docker stats resource-limit

# æ€è€ƒé¢˜ï¼š
# 1. å¦‚ä½•æŸ¥çœ‹å®¹å™¨çš„è¯¦ç»†èµ„æºé…ç½®ï¼Ÿ
# 2. å¦‚æœå®¹å™¨è¶…å‡ºå†…å­˜é™åˆ¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ
# 3. å¦‚ä½•åŠ¨æ€è°ƒæ•´è¿è¡Œä¸­å®¹å™¨çš„èµ„æºé™åˆ¶ï¼Ÿ</code></pre>
      </div>

      <div class="practice-box">
        <h3>ç»ƒä¹  3ï¼šæ—¥å¿—ç®¡ç†</h3>
        <pre><code># åˆ›å»ºæµ‹è¯•å®¹å™¨
docker run -d --name log-test \
  --log-opt max-size=1m \
  --log-opt max-file=3 \
  nginx

# äº§ç”Ÿå¤§é‡æ—¥å¿—ï¼ˆè®¿é—®å¤šæ¬¡ï¼‰
for i in {1..100}; do curl http://localhost:80; done

# æŸ¥çœ‹æ—¥å¿—é…ç½®
docker inspect log-test | grep -A 10 LogConfig

# æŸ¥çœ‹æœ€è¿‘æ—¥å¿—
docker logs --tail 20 --since 1m log-test

# æ¸…ç†
docker rm -f log-test</code></pre>
      </div>
    </section>

    <section id="summary">
      <h2>ğŸ“ è¯¾ç¨‹å°ç»“</h2>
      
      <div class="summary-box">
        <h3>æ ¸å¿ƒçŸ¥è¯†ç‚¹</h3>
        <ul class="checklist">
          <li>âœ… å®¹å™¨7ç§çŠ¶æ€ï¼šcreatedã€runningã€pausedã€restartingã€exitedã€deadã€removing</li>
          <li>âœ… ç”Ÿå‘½å‘¨æœŸæ“ä½œï¼šcreateã€startã€stopã€restartã€pauseã€unpauseã€killã€rm</li>
          <li>âœ… æ—¥å¿—ç®¡ç†ï¼š<code>docker logs</code> çš„å¤šç§å‚æ•°ï¼ˆ-fã€--tailã€--sinceã€-tï¼‰</li>
          <li>âœ… è¿›å…¥å®¹å™¨ï¼š<code>docker exec -it</code> vs <code>docker attach</code></li>
          <li>âœ… èµ„æºé™åˆ¶ï¼šCPUï¼ˆ--cpusï¼‰ã€å†…å­˜ï¼ˆ--memoryï¼‰ã€ç£ç›˜ I/O</li>
          <li>âœ… é‡å¯ç­–ç•¥ï¼šnoã€on-failureã€alwaysã€unless-stopped</li>
          <li>âœ… å®¹å™¨æ¸…ç†ï¼š<code>docker rm</code>ã€<code>--rm</code>ã€<code>docker prune</code></li>
        </ul>

        <h3>å…³é”®å‘½ä»¤å›é¡¾</h3>
        <pre><code># ç”Ÿå‘½å‘¨æœŸç®¡ç†
docker start/stop/restart/pause/unpause/kill/rm &lt;å®¹å™¨&gt;

# æ—¥å¿—æŸ¥çœ‹
docker logs -f --tail 100 --since 10m &lt;å®¹å™¨&gt;

# è¿›å…¥å®¹å™¨
docker exec -it &lt;å®¹å™¨&gt; bash

# èµ„æºé™åˆ¶
docker run -d --cpus="2" --memory="1g" --restart=unless-stopped nginx

# ç³»ç»Ÿæ¸…ç†
docker system prune -a</code></pre>

        <h3>ğŸ¯ ä¸‹èŠ‚é¢„å‘Š</h3>
        <p>ç¬¬4è®²å°†å­¦ä¹  <strong>æ•°æ®æŒä¹…åŒ–</strong>ï¼š</p>
        <ul>
          <li>ä¸ºä»€ä¹ˆå®¹å™¨æ•°æ®ä¼šä¸¢å¤±ï¼Ÿ</li>
          <li>Volume æ•°æ®å·è¯¦è§£</li>
          <li>Bind Mount ç»‘å®šæŒ‚è½½</li>
          <li>æ•°æ®å¤‡ä»½ä¸è¿ç§»</li>
        </ul>
      </div>
    </section>

    <div class="navigation-buttons">
      <router-link to="/lecture-2" class="nav-btn prev">â† ä¸Šä¸€è®²</router-link>
      <router-link to="/lecture-4" class="nav-btn next">ä¸‹ä¸€è®²ï¼šæ•°æ®æŒä¹…åŒ– â†’</router-link>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import LectureSidebar from '@/components/LectureSidebar.vue'

const sections = ref([
  { id: 'intro', title: 'ğŸ‘‹ è¯¾ç¨‹ç›®æ ‡' },
  { id: 'chapter-1', title: 'ä¸€ã€å®¹å™¨ç”Ÿå‘½å‘¨æœŸå®Œæ•´è§£æ', level: 1 },
  { id: 'chapter-2', title: 'äºŒã€å®¹å™¨æ—¥å¿—ç®¡ç†', level: 1 },
  { id: 'chapter-3', title: 'ä¸‰ã€è¿›å…¥å®¹å™¨è°ƒè¯•', level: 1 },
  { id: 'chapter-4', title: 'å››ã€å®¹å™¨èµ„æºé™åˆ¶', level: 1 },
  { id: 'chapter-5', title: 'äº”ã€å®¹å™¨æ¸…ç†ä¸ç»´æŠ¤', level: 1 },
  { id: 'practice', title: 'å…­ã€ç»¼åˆç»ƒä¹ ', level: 1 },
  { id: 'summary', title: 'ğŸ“ è¯¾ç¨‹å°ç»“', level: 1 }
])
</script>

<style lang="scss" scoped>
.coming-soon {
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 60vh;
  padding: $spacing-xl;
}

.coming-soon-card {
  @include card($spacing-xxl);
  text-align: center;
  max-width: 600px;
  background: linear-gradient(135deg, $color-bg-subtle, rgba($color-primary, 0.05));

  .coming-soon-icon {
    font-size: 4rem;
    margin-bottom: $spacing-lg;
    @include float-animation;
  }

  h2 {
    color: $color-heading;
    margin-bottom: $spacing-md;
    font-size: 1.75rem;
  }

  p {
    color: $color-text-secondary;
    margin-bottom: $spacing-xl;
    font-size: 1.125rem;
  }

  .preview-topics {
    text-align: left;
    margin-bottom: $spacing-xl;

    h3 {
      color: $color-primary;
      margin-bottom: $spacing-md;
      font-size: 1.125rem;
    }

    .checklist {
      margin-left: 0;
      
      li {
        margin-bottom: $spacing-sm;
        padding: $spacing-sm;
        background: rgba($color-primary, 0.05);
        border-left: 3px solid $color-primary;
        border-radius: 0 $border-radius $border-radius 0;
      }
    }
  }

  .navigation {
    display: flex;
    gap: $spacing-md;
    justify-content: center;

    .nav-button {
      @include button-secondary;
      text-decoration: none;
      padding: $spacing-md $spacing-lg;
    }
  }
}

.lecture-header {
  text-align: center;
  margin-bottom: $spacing-xxl;
  
  .pill-list {
    justify-content: center;
    margin-top: $spacing-lg;
  }
}
</style>