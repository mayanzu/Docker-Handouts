<template>
  <div class="lecture-page">
    <div class="page-container" :style="{ transform: `translateX(-${(currentPage - 1) * 100}%)` }">
      
      <!-- å°é¢é¡µ -->
      <div class="page cover-page">
        <div class="cover-content">
          <div class="course-badge">ğŸ³ Docker & Kubernetes å®æˆ˜è¯¾ç¨‹</div>
          <h1 class="main-title">ç¬¬11è¯¾æ—¶</h1>
          <h2 class="sub-title">Dockerå¯è§†åŒ–ä¸ç›‘æ§</h2>
          <p class="tagline">Portainerã€Prometheusä¸Grafana</p>
          <div class="meta-info">
            <span>ğŸ“š 90åˆ†é’Ÿ</span>
            <span>ğŸ¯ ç†è®º+å®æ“</span>
            <span>ğŸ“Š è¿›é˜¶çº§</span>
          </div>
        </div>
      </div>

      <!-- è¯¾ç¨‹ç›®æ ‡ -->
      <div class="page content-page">
        <div class="page-header">
          <span class="page-number">01</span>
          <h1 class="page-title">è¯¾ç¨‹ç›®æ ‡</h1>
        </div>
        <div class="page-body">
          <div class="goal-list">
            <div class="goal-item">
              <div class="goal-icon">ğŸ–¥ï¸</div>
              <div class="goal-content">
                <h3>æŒæ¡Portainer</h3>
                <p>å®¹å™¨å¯è§†åŒ–ç®¡ç†</p>
              </div>
            </div>
            <div class="goal-item">
              <div class="goal-icon">ğŸ“Š</div>
              <div class="goal-content">
                <h3>éƒ¨ç½²Prometheus</h3>
                <p>æŒ‡æ ‡é‡‡é›†ä¸å­˜å‚¨</p>
              </div>
            </div>
            <div class="goal-item">
              <div class="goal-icon">ğŸ“ˆ</div>
              <div class="goal-content">
                <h3>é…ç½®Grafana</h3>
                <p>æ•°æ®å¯è§†åŒ–å±•ç¤º</p>
              </div>
            </div>
            <div class="goal-item">
              <div class="goal-icon">ğŸ””</div>
              <div class="goal-content">
                <h3>é…ç½®å‘Šè­¦</h3>
                <p>Alertmanagerå‘Šè­¦</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- è¯¾ç¨‹å®‰æ’ -->
      <div class="page content-page">
        <div class="page-header">
          <span class="page-number">02</span>
          <h1 class="page-title">è¯¾ç¨‹å®‰æ’</h1>
        </div>
        <div class="page-body">
          <div class="schedule-grid">
            <div class="schedule-item">
              <div class="schedule-time">25åˆ†é’Ÿ</div>
              <div class="schedule-type">ç†è®ºè®²è§£</div>
              <div class="schedule-desc">ç›‘æ§ä½“ç³»ã€å·¥å…·ä»‹ç»</div>
            </div>
            <div class="schedule-item">
              <div class="schedule-time">50åˆ†é’Ÿ</div>
              <div class="schedule-type">å®æ“æ¼”ç¤º</div>
              <div class="schedule-desc">éƒ¨ç½²ç›‘æ§æ ˆã€é…ç½®é¢æ¿</div>
            </div>
            <div class="schedule-item">
              <div class="schedule-time">15åˆ†é’Ÿ</div>
              <div class="schedule-type">ç»ƒä¹ ä¸æ€»ç»“</div>
              <div class="schedule-desc">è‡ªå®šä¹‰ç›‘æ§é¢æ¿</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Part 1 æ ‡é¢˜ -->
      <div class="page section-page">
        <div class="section-content">
          <span class="section-label">Part 1</span>
          <h1 class="section-title">å®¹å™¨ç›‘æ§æ¦‚è¿°</h1>
          <p class="section-desc">ç›‘æ§ä½“ç³»ä¸å·¥å…·é€‰å‹</p>
        </div>
      </div>

      <!-- ä¸ºä»€ä¹ˆéœ€è¦ç›‘æ§ -->
      <div class="page content-page">
        <div class="page-header">
          <span class="page-number">Part 1.1</span>
          <h1 class="page-title">ä¸ºä»€ä¹ˆéœ€è¦ç›‘æ§ï¼Ÿ</h1>
        </div>
        <div class="page-body">
          <div class="pain-points-grid">
            <div class="pain-point-card" style="border-color: #fca5a5;">
              <div class="pain-icon">âš ï¸</div>
              <h3>é—®é¢˜å‘ç°</h3>
              <p>åŠæ—¶å‘ç°ç³»ç»Ÿå¼‚å¸¸</p>
            </div>
            <div class="pain-point-card" style="border-color: #fcd34d;">
              <div class="pain-icon">ğŸ“Š</div>
              <h3>æ€§èƒ½åˆ†æ</h3>
              <p>å®šä½æ€§èƒ½ç“¶é¢ˆ</p>
            </div>
            <div class="pain-point-card" style="border-color: #bbf7d0;">
              <div class="pain-icon">ğŸ“ˆ</div>
              <h3>å®¹é‡è§„åˆ’</h3>
              <p>é¢„æµ‹èµ„æºéœ€æ±‚</p>
            </div>
            <div class="pain-point-card" style="border-color: #93c5fd;">
              <div class="pain-icon">ğŸ””</div>
              <h3>å‘Šè­¦é€šçŸ¥</h3>
              <p>å¼‚å¸¸è‡ªåŠ¨å‘Šè­¦</p>
            </div>
          </div>
        </div>
      </div>

      <!-- ç›‘æ§å·¥å…·å¯¹æ¯” -->
      <div class="page content-page">
        <div class="page-header">
          <span class="page-number">Part 1.2</span>
          <h1 class="page-title">ç›‘æ§å·¥å…·å¯¹æ¯”</h1>
        </div>
        <div class="page-body">
          <table class="compare-table full-width">
            <thead>
              <tr>
                <th>å·¥å…·</th>
                <th>ç”¨é€”</th>
                <th>ç‰¹ç‚¹</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Portainer</strong></td>
                <td>å¯è§†åŒ–ç®¡ç†</td>
                <td>Web UIç®¡ç†å®¹å™¨</td>
              </tr>
              <tr>
                <td><strong>Prometheus</strong></td>
                <td>æŒ‡æ ‡é‡‡é›†</td>
                <td>æ—¶åºæ•°æ®åº“ã€Pullæ¨¡å¼</td>
              </tr>
              <tr>
                <td><strong>Grafana</strong></td>
                <td>å¯è§†åŒ–</td>
                <td>ä¸°å¯Œçš„å›¾è¡¨é¢æ¿</td>
              </tr>
              <tr>
                <td><strong>cAdvisor</strong></td>
                <td>å®¹å™¨ç›‘æ§</td>
                <td>å®¹å™¨èµ„æºä½¿ç”¨ç›‘æ§</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Part 2 æ ‡é¢˜ -->
      <div class="page section-page">
        <div class="section-content">
          <span class="section-label">Part 2</span>
          <h1 class="section-title">Portainerå¯è§†åŒ–ç®¡ç†</h1>
          <p class="section-desc">Web UIç®¡ç†å®¹å™¨</p>
        </div>
      </div>

      <!-- Portaineréƒ¨ç½² -->
      <div class="page content-page">
        <div class="page-header">
          <span class="page-number">Part 2.1</span>
          <h1 class="page-title">éƒ¨ç½²Portainer</h1>
        </div>
        <div class="page-body">
          <div class="code-block">
            <div class="code-header">
              <span class="code-title">å¯åŠ¨Portainer</span>
            </div>
            <pre><code>docker run -d --name portainer \
  -p 9000:9000 \
  -v /var/run/docker.sock:/var/run/docker.sock \
  -v portainer-data:/data \
  portainer/portainer-ce:latest

# è®¿é—®Web UI
# http://localhost:9000</code></pre>
          </div>
          <div class="param-list">
            <div class="param-item">
              <span class="param-name">docker.sock</span>
              <span class="param-desc">è¿æ¥Dockerå®ˆæŠ¤è¿›ç¨‹</span>
            </div>
            <div class="param-item">
              <span class="param-name">portainer-data</span>
              <span class="param-desc">æŒä¹…åŒ–é…ç½®æ•°æ®</span>
            </div>
          </div>
        </div>
      </div>

      <!-- PortaineråŠŸèƒ½ -->
      <div class="page content-page">
        <div class="page-header">
          <span class="page-number">Part 2.2</span>
          <h1 class="page-title">Portainerä¸»è¦åŠŸèƒ½</h1>
        </div>
        <div class="page-body">
          <div class="feature-list">
            <div class="feature-item">
              <span class="feature-icon">âœ“</span>
              <span>å®¹å™¨ç®¡ç†ï¼šåˆ›å»ºã€å¯åŠ¨ã€åœæ­¢ã€åˆ é™¤å®¹å™¨</span>
            </div>
            <div class="feature-item">
              <span class="feature-icon">âœ“</span>
              <span>é•œåƒç®¡ç†ï¼šæ‹‰å–ã€åˆ é™¤ã€æ„å»ºé•œåƒ</span>
            </div>
            <div class="feature-item">
              <span class="feature-icon">âœ“</span>
              <span>ç½‘ç»œç®¡ç†ï¼šåˆ›å»ºå’Œç®¡ç†Dockerç½‘ç»œ</span>
            </div>
            <div class="feature-item">
              <span class="feature-icon">âœ“</span>
              <span>å·ç®¡ç†ï¼šç®¡ç†æ•°æ®å·</span>
            </div>
            <div class="feature-item">
              <span class="feature-icon">âœ“</span>
              <span>æ—¥å¿—æŸ¥çœ‹ï¼šå®æ—¶æŸ¥çœ‹å®¹å™¨æ—¥å¿—</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Part 3 æ ‡é¢˜ -->
      <div class="page section-page">
        <div class="section-content">
          <span class="section-label">Part 3</span>
          <h1 class="section-title">Prometheusç›‘æ§</h1>
          <p class="section-desc">æŒ‡æ ‡é‡‡é›†ä¸å­˜å‚¨</p>
        </div>
      </div>

      <!-- Prometheusæ¶æ„ -->
      <div class="page content-page">
        <div class="page-header">
          <span class="page-number">Part 3.1</span>
          <h1 class="page-title">Prometheusæ¶æ„</h1>
        </div>
        <div class="page-body">
          <div class="arch-diagram vertical">
            <div class="arch-box exporter-box">
              <div class="box-title">Exporters</div>
              <div class="box-content">
                <div class="box-item">Node Exporter</div>
                <div class="box-item">cAdvisor</div>
              </div>
            </div>
            <div class="arch-flow">
              <span class="flow-arrow">â†“ Pull</span>
            </div>
            <div class="arch-box prometheus-box">
              <div class="box-title">Prometheus</div>
              <div class="box-content">
                <div class="box-item">é‡‡é›† + å­˜å‚¨</div>
                <div class="box-item">å‘Šè­¦è§„åˆ™</div>
              </div>
            </div>
            <div class="arch-flow">
              <span class="flow-arrow">â†“</span>
            </div>
            <div class="arch-box grafana-box">
              <div class="box-title">Grafana</div>
              <div class="box-content">
                <div class="box-item">å¯è§†åŒ–å±•ç¤º</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- éƒ¨ç½²Prometheus -->
      <div class="page content-page">
        <div class="page-header">
          <span class="page-number">Part 3.2</span>
          <h1 class="page-title">éƒ¨ç½²Prometheus</h1>
        </div>
        <div class="page-body">
          <div class="code-block">
            <div class="code-header">
              <span class="code-title">prometheus.ymlé…ç½®</span>
            </div>
            <pre><code>global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  - job_name: 'cadvisor'
    static_configs:
      - targets: ['cadvisor:8080']</code></pre>
          </div>
          <div class="code-block">
            <div class="code-header">
              <span class="code-title">å¯åŠ¨Prometheus</span>
            </div>
            <pre><code>docker run -d --name prometheus \
  -p 9090:9090 \
  -v ./prometheus.yml:/etc/prometheus/prometheus.yml \
  prom/prometheus:latest</code></pre>
          </div>
        </div>
      </div>

      <!-- cAdvisor -->
      <div class="page content-page">
        <div class="page-header">
          <span class="page-number">Part 3.3</span>
          <h1 class="page-title">éƒ¨ç½²cAdvisor</h1>
        </div>
        <div class="page-body">
          <div class="definition-box">
            <div class="definition-term">cAdvisor</div>
            <div class="definition-content">
              Googleå¼€æºçš„å®¹å™¨èµ„æºç›‘æ§å·¥å…·ï¼Œè‡ªåŠ¨é‡‡é›†å®¹å™¨çš„CPUã€å†…å­˜ã€ç½‘ç»œã€ç£ç›˜ç­‰æŒ‡æ ‡ã€‚
            </div>
          </div>
          <div class="code-block">
            <div class="code-header">
              <span class="code-title">å¯åŠ¨cAdvisor</span>
            </div>
            <pre><code>docker run -d --name cadvisor \
  -p 8080:8080 \
  -v /:/rootfs:ro \
  -v /var/run:/var/run:ro \
  -v /sys:/sys:ro \
  -v /var/lib/docker:/var/lib/docker:ro \
  google/cadvisor:latest</code></pre>
          </div>
        </div>
      </div>

      <!-- Part 4 æ ‡é¢˜ -->
      <div class="page section-page">
        <div class="section-content">
          <span class="section-label">Part 4</span>
          <h1 class="section-title">Grafanaå¯è§†åŒ–</h1>
          <p class="section-desc">æ•°æ®å¯è§†åŒ–å±•ç¤º</p>
        </div>
      </div>

      <!-- éƒ¨ç½²Grafana -->
      <div class="page content-page">
        <div class="page-header">
          <span class="page-number">Part 4.1</span>
          <h1 class="page-title">éƒ¨ç½²Grafana</h1>
        </div>
        <div class="page-body">
          <div class="code-block">
            <div class="code-header">
              <span class="code-title">å¯åŠ¨Grafana</span>
            </div>
            <pre><code>docker run -d --name grafana \
  -p 3000:3000 \
  -v grafana-data:/var/lib/grafana \
  grafana/grafana:latest

# è®¿é—®Web UI
# http://localhost:3000
# é»˜è®¤è´¦å·ï¼šadmin/admin</code></pre>
          </div>
        </div>
      </div>

      <!-- é…ç½®æ•°æ®æº -->
      <div class="page content-page">
        <div class="page-header">
          <span class="page-number">Part 4.2</span>
          <h1 class="page-title">é…ç½®Prometheusæ•°æ®æº</h1>
        </div>
        <div class="page-body">
          <div class="install-step">
            <div class="step-number">Step 1</div>
            <div class="step-content">
              <h4>æ·»åŠ æ•°æ®æº</h4>
              <p class="paragraph">Configuration â†’ Data Sources â†’ Add data source</p>
            </div>
          </div>
          <div class="install-step">
            <div class="step-number">Step 2</div>
            <div class="step-content">
              <h4>é€‰æ‹©Prometheus</h4>
              <p class="paragraph">URLå¡«å†™ï¼šhttp://prometheus:9090</p>
            </div>
          </div>
          <div class="install-step">
            <div class="step-number">Step 3</div>
            <div class="step-content">
              <h4>å¯¼å…¥Dashboard</h4>
              <p class="paragraph">å¯¼å…¥IDï¼š893ï¼ˆDockerç›‘æ§é¢æ¿ï¼‰</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Part 5 æ ‡é¢˜ -->
      <div class="page section-page">
        <div class="section-content">
          <span class="section-label">Part 5</span>
          <h1 class="section-title">éšå ‚ç»ƒä¹ </h1>
          <p class="section-desc">å·©å›ºæ‰€å­¦çŸ¥è¯†</p>
        </div>
      </div>

      <!-- ç»ƒä¹ ä»»åŠ¡ -->
      <div class="page content-page">
        <div class="page-header">
          <span class="page-number">Part 5</span>
          <h1 class="page-title">ç»ƒä¹ ä»»åŠ¡ï¼ˆ15åˆ†é’Ÿï¼‰</h1>
        </div>
        <div class="page-body">
          <div class="exercise-tasks">
            <div class="exercise-task">
              <div class="task-number">1</div>
              <div class="task-content">
                <h3>éƒ¨ç½²Portainer</h3>
                <p>ä½¿ç”¨Dockerå¯åŠ¨Portainer</p>
              </div>
            </div>
            <div class="exercise-task">
              <div class="task-number">2</div>
              <div class="task-content">
                <h3>éƒ¨ç½²ç›‘æ§æ ˆ</h3>
                <p>Prometheus + cAdvisor + Grafana</p>
              </div>
            </div>
            <div class="exercise-task">
              <div class="task-number">3</div>
              <div class="task-content">
                <h3>é…ç½®Dashboard</h3>
                <p>å¯¼å…¥Dockerç›‘æ§é¢æ¿</p>
              </div>
            </div>
            <div class="exercise-task">
              <div class="task-number">4</div>
              <div class="task-content">
                <h3>æäº¤æˆªå›¾</h3>
                <p>Grafanaç›‘æ§é¢æ¿æˆªå›¾</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- è¯¾ç¨‹æ€»ç»“ -->
      <div class="page content-page">
        <div class="page-header">
          <span class="page-number">æ€»ç»“</span>
          <h1 class="page-title">æœ¬è¯¾æ—¶å°ç»“</h1>
        </div>
        <div class="page-body">
          <div class="summary-grid">
            <div class="summary-item">
              <div class="summary-icon">âœ…</div>
              <div class="summary-text">Portainerï¼šWeb UIå¯è§†åŒ–ç®¡ç†å®¹å™¨</div>
            </div>
            <div class="summary-item">
              <div class="summary-icon">âœ…</div>
              <div class="summary-text">Prometheusï¼šæŒ‡æ ‡é‡‡é›†ä¸å­˜å‚¨</div>
            </div>
            <div class="summary-item">
              <div class="summary-icon">âœ…</div>
              <div class="summary-text">cAdvisorï¼šå®¹å™¨èµ„æºç›‘æ§</div>
            </div>
            <div class="summary-item">
              <div class="summary-icon">âœ…</div>
              <div class="summary-text">Grafanaï¼šæ•°æ®å¯è§†åŒ–å±•ç¤º</div>
            </div>
          </div>
        </div>
      </div>

      <!-- ä¸‹èŠ‚é¢„å‘Š -->
      <div class="page content-page">
        <div class="page-header">
          <span class="page-number">é¢„å‘Š</span>
          <h1 class="page-title">ä¸‹èŠ‚é¢„å‘Š</h1>
        </div>
        <div class="page-body">
          <div class="next-lecture">
            <h3>ğŸ“š ç¬¬12è¯¾æ—¶ï¼šä¼ä¸šå®æˆ˜ä¸é¢è¯•é¢˜</h3>
            <ul>
              <li>ä¼ä¸šçº§é•œåƒæ„å»º</li>
              <li>CI/CDæµæ°´çº¿</li>
              <li>å¸¸è§é¢è¯•é¢˜è§£æ</li>
              <li>å®æˆ˜æ¡ˆä¾‹åˆ†äº«</li>
            </ul>
          </div>
        </div>
      </div>

    </div>

    <!-- é¡µé¢å¯¼èˆª -->
    <div class="page-navigation">
      <button class="nav-btn prev" @click="prevPage" :disabled="currentPage === 1">
        â† ä¸Šä¸€é¡µ
      </button>
      <div class="page-indicator">
        <span class="current">{{ currentPage }}</span>
        <span class="separator">/</span>
        <span class="total">{{ totalPages }}</span>
      </div>
      <button class="nav-btn next" @click="nextPage" :disabled="currentPage === totalPages">
        ä¸‹ä¸€é¡µ â†’
      </button>
    </div>

    <!-- é¡µé¢ç¼©ç•¥å›¾å¯¼èˆª -->
    <div class="page-thumbnails">
      <div 
        v-for="i in totalPages" 
        :key="i" 
        class="thumbnail" 
        :class="{ active: currentPage === i }"
        @click="goToPage(i)"
      >
        {{ i }}
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted, onUnmounted } from 'vue'

const currentPage = ref(1)
const totalPages = 20

const nextPage = () => {
  if (currentPage.value < totalPages) {
    currentPage.value++
  }
}

const prevPage = () => {
  if (currentPage.value > 1) {
    currentPage.value--
  }
}

const goToPage = (page: number) => {
  currentPage.value = page
}

const handleKeydown = (e: KeyboardEvent) => {
  if (e.key === 'ArrowRight' || e.key === 'ArrowDown' || e.key === ' ') {
    nextPage()
  } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
    prevPage()
  } else if (e.key === 'Home') {
    currentPage.value = 1
  } else if (e.key === 'End') {
    currentPage.value = totalPages
  }
}

onMounted(() => {
  window.addEventListener('keydown', handleKeydown)
})

onUnmounted(() => {
  window.removeEventListener('keydown', handleKeydown)
})
</script>

<style lang="scss" scoped>
@import './styles/lecture-common.scss';
</style>
